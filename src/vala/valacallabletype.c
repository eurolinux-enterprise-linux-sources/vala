/* valacallabletype.c generated by valac, the Vala compiler
 * generated from valacallabletype.vala, do not modify */

/* valacallabletype.vala
 *
 * Copyright (C) 2017  Rico Tzschichholz
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.

 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.

 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA
 *
 * Author:
 * 	Rico Tzschichholz <ricotz@ubuntu.com>
 */


#include <glib.h>
#include <glib-object.h>
#include "vala.h"
#include <stdlib.h>
#include <string.h>
#include <valagee.h>

#define _g_free0(var) (var = (g_free (var), NULL))
#define _vala_code_node_unref0(var) ((var == NULL) ? NULL : (var = (vala_code_node_unref (var), NULL)))
#define _vala_iterable_unref0(var) ((var == NULL) ? NULL : (var = (vala_iterable_unref (var), NULL)))
#define _g_string_free0(var) ((var == NULL) ? NULL : (var = (g_string_free (var, TRUE), NULL)))


static gpointer vala_callable_type_parent_class = NULL;

static gchar* vala_callable_type_real_to_prototype_string (ValaDataType* base,
                                                    const gchar* override_name);


static gpointer
_vala_code_node_ref0 (gpointer self)
{
	return self ? vala_code_node_ref (self) : NULL;
}


static gpointer
_vala_iterable_ref0 (gpointer self)
{
	return self ? vala_iterable_ref (self) : NULL;
}


static gchar*
vala_callable_type_real_to_prototype_string (ValaDataType* base,
                                             const gchar* override_name)
{
	ValaCallableType * self;
	gchar* result = NULL;
	GString* builder = NULL;
	GString* _tmp0_;
	ValaDataType* return_type = NULL;
	ValaDataType* _tmp1_;
	ValaDataType* _tmp2_;
	GString* _tmp4_;
	ValaDataType* _tmp5_;
	gchar* _tmp6_;
	gchar* _tmp7_;
	GString* _tmp8_;
	gchar* _tmp9_ = NULL;
	gchar* _tmp10_;
	GString* _tmp12_;
	GString* _tmp13_;
	GString* _tmp14_;
	gint i = 0;
	ValaDelegateType* delegate_type = NULL;
	ValaDelegateType* _tmp15_;
	ValaDelegateType* _tmp16_;
	GString* _tmp95_;
	ValaList* error_types = NULL;
	ValaList* _tmp96_;
	ValaList* _tmp97_;
	gint _tmp98_;
	gint _tmp99_;
	GString* _tmp118_;
	const gchar* _tmp119_;
	gchar* _tmp120_;
	self = (ValaCallableType*) base;
	_tmp0_ = g_string_new ("");
	builder = _tmp0_;
	_tmp1_ = vala_data_type_get_return_type ((ValaDataType*) self);
	return_type = _tmp1_;
	_tmp2_ = return_type;
	if (vala_data_type_is_weak (_tmp2_)) {
		GString* _tmp3_;
		_tmp3_ = builder;
		g_string_append (_tmp3_, "unowned ");
	}
	_tmp4_ = builder;
	_tmp5_ = return_type;
	_tmp6_ = vala_data_type_to_qualified_string (_tmp5_, NULL);
	_tmp7_ = _tmp6_;
	g_string_append (_tmp4_, _tmp7_);
	_g_free0 (_tmp7_);
	_tmp8_ = builder;
	g_string_append_c (_tmp8_, ' ');
	_tmp10_ = g_strdup (override_name);
	_tmp9_ = _tmp10_;
	if (_tmp9_ == NULL) {
		gchar* _tmp11_;
		_tmp11_ = vala_code_node_to_string ((ValaCodeNode*) self);
		_g_free0 (_tmp9_);
		_tmp9_ = _tmp11_;
	}
	_tmp12_ = builder;
	g_string_append (_tmp12_, _tmp9_);
	_tmp13_ = builder;
	g_string_append_c (_tmp13_, ' ');
	_tmp14_ = builder;
	g_string_append_c (_tmp14_, '(');
	i = 1;
	_tmp15_ = _vala_code_node_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (self, VALA_TYPE_DELEGATE_TYPE) ? ((ValaDelegateType*) self) : NULL);
	delegate_type = _tmp15_;
	_tmp16_ = delegate_type;
	if (_tmp16_ != NULL) {
		ValaDelegate* delegate_symbol = NULL;
		ValaDelegateType* _tmp17_;
		ValaDelegate* _tmp18_;
		ValaDelegate* _tmp19_;
		ValaDelegate* _tmp20_;
		gboolean _tmp21_ = FALSE;
		ValaDelegate* _tmp22_;
		ValaSymbol* _tmp23_;
		ValaSymbol* _tmp24_;
		_tmp17_ = delegate_type;
		_tmp18_ = vala_delegate_type_get_delegate_symbol (_tmp17_);
		_tmp19_ = _tmp18_;
		_tmp20_ = _vala_code_node_ref0 (_tmp19_);
		delegate_symbol = _tmp20_;
		_tmp22_ = delegate_symbol;
		_tmp23_ = vala_symbol_get_parent_symbol ((ValaSymbol*) _tmp22_);
		_tmp24_ = _tmp23_;
		if (G_TYPE_CHECK_INSTANCE_TYPE (_tmp24_, VALA_TYPE_SIGNAL)) {
			ValaDelegate* _tmp25_;
			ValaDataType* _tmp26_;
			ValaDataType* _tmp27_;
			_tmp25_ = delegate_symbol;
			_tmp26_ = vala_delegate_get_sender_type (_tmp25_);
			_tmp27_ = _tmp26_;
			_tmp21_ = _tmp27_ != NULL;
		} else {
			_tmp21_ = FALSE;
		}
		if (_tmp21_) {
			GString* _tmp28_;
			ValaDelegate* _tmp29_;
			ValaDataType* _tmp30_;
			ValaDataType* _tmp31_;
			gchar* _tmp32_;
			gchar* _tmp33_;
			gint _tmp34_;
			_tmp28_ = builder;
			_tmp29_ = delegate_symbol;
			_tmp30_ = vala_delegate_get_sender_type (_tmp29_);
			_tmp31_ = _tmp30_;
			_tmp32_ = vala_data_type_to_qualified_string (_tmp31_, NULL);
			_tmp33_ = _tmp32_;
			g_string_append (_tmp28_, _tmp33_);
			_g_free0 (_tmp33_);
			_tmp34_ = i;
			i = _tmp34_ + 1;
		}
		_vala_code_node_unref0 (delegate_symbol);
	}
	{
		ValaList* _param_list = NULL;
		ValaList* _tmp35_;
		gint _param_size = 0;
		ValaList* _tmp36_;
		gint _tmp37_;
		gint _tmp38_;
		gint _param_index = 0;
		_tmp35_ = vala_data_type_get_parameters ((ValaDataType*) self);
		_param_list = _tmp35_;
		_tmp36_ = _param_list;
		_tmp37_ = vala_collection_get_size ((ValaCollection*) _tmp36_);
		_tmp38_ = _tmp37_;
		_param_size = _tmp38_;
		_param_index = -1;
		while (TRUE) {
			gint _tmp39_;
			gint _tmp40_;
			gint _tmp41_;
			ValaParameter* param = NULL;
			ValaList* _tmp42_;
			gint _tmp43_;
			gpointer _tmp44_;
			gint _tmp45_;
			ValaParameter* _tmp47_;
			gboolean _tmp48_;
			gboolean _tmp49_;
			ValaParameter* _tmp51_;
			ValaParameterDirection _tmp52_;
			ValaParameterDirection _tmp53_;
			GString* _tmp78_;
			ValaParameter* _tmp79_;
			ValaDataType* _tmp80_;
			ValaDataType* _tmp81_;
			gchar* _tmp82_;
			gchar* _tmp83_;
			ValaParameter* _tmp84_;
			ValaExpression* _tmp85_;
			ValaExpression* _tmp86_;
			gint _tmp94_;
			_tmp39_ = _param_index;
			_param_index = _tmp39_ + 1;
			_tmp40_ = _param_index;
			_tmp41_ = _param_size;
			if (!(_tmp40_ < _tmp41_)) {
				break;
			}
			_tmp42_ = _param_list;
			_tmp43_ = _param_index;
			_tmp44_ = vala_list_get (_tmp42_, _tmp43_);
			param = (ValaParameter*) _tmp44_;
			_tmp45_ = i;
			if (_tmp45_ > 1) {
				GString* _tmp46_;
				_tmp46_ = builder;
				g_string_append (_tmp46_, ", ");
			}
			_tmp47_ = param;
			_tmp48_ = vala_parameter_get_ellipsis (_tmp47_);
			_tmp49_ = _tmp48_;
			if (_tmp49_) {
				GString* _tmp50_;
				_tmp50_ = builder;
				g_string_append (_tmp50_, "...");
				_vala_code_node_unref0 (param);
				continue;
			}
			_tmp51_ = param;
			_tmp52_ = vala_parameter_get_direction (_tmp51_);
			_tmp53_ = _tmp52_;
			if (_tmp53_ == VALA_PARAMETER_DIRECTION_IN) {
				ValaParameter* _tmp54_;
				ValaDataType* _tmp55_;
				ValaDataType* _tmp56_;
				gboolean _tmp57_;
				gboolean _tmp58_;
				_tmp54_ = param;
				_tmp55_ = vala_variable_get_variable_type ((ValaVariable*) _tmp54_);
				_tmp56_ = _tmp55_;
				_tmp57_ = vala_data_type_get_value_owned (_tmp56_);
				_tmp58_ = _tmp57_;
				if (_tmp58_) {
					GString* _tmp59_;
					_tmp59_ = builder;
					g_string_append (_tmp59_, "owned ");
				}
			} else {
				ValaParameter* _tmp60_;
				ValaParameterDirection _tmp61_;
				ValaParameterDirection _tmp62_;
				gboolean _tmp68_ = FALSE;
				ValaParameter* _tmp69_;
				ValaDataType* _tmp70_;
				ValaDataType* _tmp71_;
				gboolean _tmp72_;
				gboolean _tmp73_;
				_tmp60_ = param;
				_tmp61_ = vala_parameter_get_direction (_tmp60_);
				_tmp62_ = _tmp61_;
				if (_tmp62_ == VALA_PARAMETER_DIRECTION_REF) {
					GString* _tmp63_;
					_tmp63_ = builder;
					g_string_append (_tmp63_, "ref ");
				} else {
					ValaParameter* _tmp64_;
					ValaParameterDirection _tmp65_;
					ValaParameterDirection _tmp66_;
					_tmp64_ = param;
					_tmp65_ = vala_parameter_get_direction (_tmp64_);
					_tmp66_ = _tmp65_;
					if (_tmp66_ == VALA_PARAMETER_DIRECTION_OUT) {
						GString* _tmp67_;
						_tmp67_ = builder;
						g_string_append (_tmp67_, "out ");
					}
				}
				_tmp69_ = param;
				_tmp70_ = vala_variable_get_variable_type ((ValaVariable*) _tmp69_);
				_tmp71_ = _tmp70_;
				_tmp72_ = vala_data_type_get_value_owned (_tmp71_);
				_tmp73_ = _tmp72_;
				if (!_tmp73_) {
					ValaParameter* _tmp74_;
					ValaDataType* _tmp75_;
					ValaDataType* _tmp76_;
					_tmp74_ = param;
					_tmp75_ = vala_variable_get_variable_type ((ValaVariable*) _tmp74_);
					_tmp76_ = _tmp75_;
					_tmp68_ = G_TYPE_CHECK_INSTANCE_TYPE (_tmp76_, VALA_TYPE_REFERENCE_TYPE);
				} else {
					_tmp68_ = FALSE;
				}
				if (_tmp68_) {
					GString* _tmp77_;
					_tmp77_ = builder;
					g_string_append (_tmp77_, "weak ");
				}
			}
			_tmp78_ = builder;
			_tmp79_ = param;
			_tmp80_ = vala_variable_get_variable_type ((ValaVariable*) _tmp79_);
			_tmp81_ = _tmp80_;
			_tmp82_ = vala_data_type_to_qualified_string (_tmp81_, NULL);
			_tmp83_ = _tmp82_;
			g_string_append (_tmp78_, _tmp83_);
			_g_free0 (_tmp83_);
			_tmp84_ = param;
			_tmp85_ = vala_variable_get_initializer ((ValaVariable*) _tmp84_);
			_tmp86_ = _tmp85_;
			if (_tmp86_ != NULL) {
				GString* _tmp87_;
				GString* _tmp88_;
				ValaParameter* _tmp89_;
				ValaExpression* _tmp90_;
				ValaExpression* _tmp91_;
				gchar* _tmp92_;
				gchar* _tmp93_;
				_tmp87_ = builder;
				g_string_append (_tmp87_, " = ");
				_tmp88_ = builder;
				_tmp89_ = param;
				_tmp90_ = vala_variable_get_initializer ((ValaVariable*) _tmp89_);
				_tmp91_ = _tmp90_;
				_tmp92_ = vala_code_node_to_string ((ValaCodeNode*) _tmp91_);
				_tmp93_ = _tmp92_;
				g_string_append (_tmp88_, _tmp93_);
				_g_free0 (_tmp93_);
			}
			_tmp94_ = i;
			i = _tmp94_ + 1;
			_vala_code_node_unref0 (param);
		}
		_vala_iterable_unref0 (_param_list);
	}
	_tmp95_ = builder;
	g_string_append_c (_tmp95_, ')');
	_tmp96_ = vala_code_node_get_error_types ((ValaCodeNode*) self);
	error_types = _tmp96_;
	_tmp97_ = error_types;
	_tmp98_ = vala_collection_get_size ((ValaCollection*) _tmp97_);
	_tmp99_ = _tmp98_;
	if (_tmp99_ > 0) {
		GString* _tmp100_;
		gboolean first = FALSE;
		_tmp100_ = builder;
		g_string_append (_tmp100_, " throws ");
		first = TRUE;
		{
			ValaList* _type_list = NULL;
			ValaList* _tmp101_;
			ValaList* _tmp102_;
			gint _type_size = 0;
			ValaList* _tmp103_;
			gint _tmp104_;
			gint _tmp105_;
			gint _type_index = 0;
			_tmp101_ = error_types;
			_tmp102_ = _vala_iterable_ref0 (_tmp101_);
			_type_list = _tmp102_;
			_tmp103_ = _type_list;
			_tmp104_ = vala_collection_get_size ((ValaCollection*) _tmp103_);
			_tmp105_ = _tmp104_;
			_type_size = _tmp105_;
			_type_index = -1;
			while (TRUE) {
				gint _tmp106_;
				gint _tmp107_;
				gint _tmp108_;
				ValaDataType* type = NULL;
				ValaList* _tmp109_;
				gint _tmp110_;
				gpointer _tmp111_;
				gboolean _tmp112_;
				GString* _tmp114_;
				ValaDataType* _tmp115_;
				gchar* _tmp116_;
				gchar* _tmp117_;
				_tmp106_ = _type_index;
				_type_index = _tmp106_ + 1;
				_tmp107_ = _type_index;
				_tmp108_ = _type_size;
				if (!(_tmp107_ < _tmp108_)) {
					break;
				}
				_tmp109_ = _type_list;
				_tmp110_ = _type_index;
				_tmp111_ = vala_list_get (_tmp109_, _tmp110_);
				type = (ValaDataType*) _tmp111_;
				_tmp112_ = first;
				if (!_tmp112_) {
					GString* _tmp113_;
					_tmp113_ = builder;
					g_string_append (_tmp113_, ", ");
				} else {
					first = FALSE;
				}
				_tmp114_ = builder;
				_tmp115_ = type;
				_tmp116_ = vala_code_node_to_string ((ValaCodeNode*) _tmp115_);
				_tmp117_ = _tmp116_;
				g_string_append (_tmp114_, _tmp117_);
				_g_free0 (_tmp117_);
				_vala_code_node_unref0 (type);
			}
			_vala_iterable_unref0 (_type_list);
		}
	}
	_tmp118_ = builder;
	_tmp119_ = _tmp118_->str;
	_tmp120_ = g_strdup (_tmp119_);
	result = _tmp120_;
	_vala_iterable_unref0 (error_types);
	_vala_code_node_unref0 (delegate_type);
	_g_free0 (_tmp9_);
	_vala_code_node_unref0 (return_type);
	_g_string_free0 (builder);
	return result;
}


ValaCallableType*
vala_callable_type_construct (GType object_type)
{
	ValaCallableType* self = NULL;
	self = (ValaCallableType*) vala_data_type_construct (object_type);
	return self;
}


static void
vala_callable_type_class_init (ValaCallableTypeClass * klass)
{
	vala_callable_type_parent_class = g_type_class_peek_parent (klass);
	((ValaDataTypeClass *) klass)->to_prototype_string = (gchar* (*) (ValaDataType *, const gchar*)) vala_callable_type_real_to_prototype_string;
}


static void
vala_callable_type_instance_init (ValaCallableType * self)
{
}


/**
 * A callable type, i.e. a delegate, method, or signal type.
 */
GType
vala_callable_type_get_type (void)
{
	static volatile gsize vala_callable_type_type_id__volatile = 0;
	if (g_once_init_enter (&vala_callable_type_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (ValaCallableTypeClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) vala_callable_type_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ValaCallableType), 0, (GInstanceInitFunc) vala_callable_type_instance_init, NULL };
		GType vala_callable_type_type_id;
		vala_callable_type_type_id = g_type_register_static (VALA_TYPE_DATA_TYPE, "ValaCallableType", &g_define_type_info, G_TYPE_FLAG_ABSTRACT);
		g_once_init_leave (&vala_callable_type_type_id__volatile, vala_callable_type_type_id);
	}
	return vala_callable_type_type_id__volatile;
}



